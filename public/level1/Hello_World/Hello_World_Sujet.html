<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Hello world!</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="container">

    <!-- Header -->
    <div class="header">
      <span class="icon">üü©</span>
      <h1 id="title">Hello world!</h1>
      <span class="badge decouverte">Introduction</span>
    </div>

    <!-- Tabs -->
    <div class="tabs">
      <button class="active">Subject</button>
      <button id="tab-resoudre">Solve</button>
      <button id="tab-conseils">Hints</button>
      <button id="tab-correction">Solution</button>
    </div>

    <!-- Content -->
    <div class="content">
      <h2>Story</h2>
      <p id="story-subject">Loading...</p>

      <h2>What your program should do:</h2>
      <p id="subject">Loading...</p>
    </div>

    <!-- Footer -->
    <div class="footer">
      <a href="../acceuil.html">‚¨ÜÔ∏è</a>
      <a href="#">‚û°Ô∏è</a>
    </div>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id") || "1";

    async function fetchExo() {
      try {
        const res = await fetch(`/api/exo/${id}`);
        const exo = await res.json();

        // Secure HTML injection
        document.getElementById("story-subject").innerHTML = exo["story_subject"] || "Content unavailable.";
        document.getElementById("subject").innerHTML = exo["subject"] || "Content unavailable.";

      } catch (e) {
        document.getElementById("story-subject").textContent = "Error while loading.";
        document.getElementById("subject").textContent = "";
        console.error(e);
      }
    }

    // Update tabs dynamically
    document.getElementById("tab-resoudre").onclick = () =>
      window.location.href = `Hello_World_Resoudre.html?id=${id}`;
    document.getElementById("tab-conseils").onclick = () =>
      window.location.href = `Hello_World_Conseils.html?id=${id}`;
    document.getElementById("tab-correction").onclick = () =>
      window.location.href = `Hello_World_Correction.html?id=${id}`;

    window.onload = fetchExo;
  </script>

</body>

</html>